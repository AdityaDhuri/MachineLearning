from sqlalchemy import create_engine
from datetime import datetime
import psycopg2
import pandas as pd
import warnings
warnings.filterwarnings("ignore")

# Current time and formats it to the North American time of Month, Day, and Year.
now = datetime.now()
dt_string = now.strftime("%m-%d-%Y_%H-%M")

cnx = psycopg2.connect(
    host="localhost",
    database="Sapient",
    user="postgres",
    password="nihilent@123")
password = "nihilent@123"
cnx = psycopg2.connect("dbname=Sapient user=postgres password=nihilent@123")
engine = create_engine("postgresql://vikasbhatt:vikas@localhost/Sapient")
print(engine)


df = "select SAP_SCH_NAME,AMC_RTA_CODE from scheme_master where RTA = 'CAMS';"
df = pd.read_sql(df,cnx)

df.to_sql(con=engine, name='karvy_16feb_all', if_exists='replace',index=False)

df.to_csv('E:\\new\\Final_KARVY_10_Nov.csv', index=False, encoding="utf-8")
